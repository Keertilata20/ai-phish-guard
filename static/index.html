<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Phish Guard</title>
 <link rel="stylesheet" href="/static/style.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>

<div class="container">

<h1>ğŸ›¡ï¸ AI Phish Guard</h1>
<p class="tagline">Detecting deception before it detects you</p>

<div class="input-area">
<input type="text" id="urlInput" placeholder="Enter URL to scan...">
<button id="scanBtn" onclick="scanURL()">Scan Now</button>
</div>

<p id="scanStatus"></p>

<!-- RESULT -->

<div id="resultBox" class="result-box hidden">
    <h2 id="resultText"></h2>


<div class="risk-bar">
    <div id="riskFill"></div>
</div>
<p id="riskPercent"></p>


</div>

<!-- TIMELINE -->

<div id="timeline" class="timeline hidden">
<p>ğŸ”’ Initializing shield...</p>
<p>ğŸŒ Expanding short link...</p>
<p>ğŸ§  AI analysing behaviour...</p>
<p>âš ï¸ Risk modeling...</p>
</div>

<!-- EXPANDED LINK -->

<div id="expandedBox" class="expanded hidden">
    <h3>Link Analysis</h3>

    <p><strong>Original:</strong></p>
    <p id="originalLink"></p>

    <p><strong>Expanded Destination:</strong></p>
    <p id="expandedLink"></p>
</div>

<!-- CONFIDENCE -->

<div id="confidenceBox" class="confidence hidden">

<h3>Confidence Breakdown</h3>

<div class="bar">
<span>Structure Risk</span>
<div class="bar-bg"><div id="structureBar"></div></div>
</div>

<div class="bar">
<span>Domain Risk</span>
<div class="bar-bg"><div id="domainBar"></div></div>
</div>

<div class="bar">
<span>Behaviour Risk</span>
<div class="bar-bg"><div id="behaviourBar"></div></div>
</div>

</div>

<!-- REASONS -->

<div id="reasonBox" class="reason-box hidden">
<h3>Why this link is risky ? </h3>
<ul id="reasonList"></ul>
</div>

</div>

<script>
async function scanURL() {

    const btn = document.getElementById("scanBtn");
    const status = document.getElementById("scanStatus");
    const resultBox = document.getElementById("resultBox");
    const resultText = document.getElementById("resultText");
    const riskFill = document.getElementById("riskFill");
    const riskPercent = document.getElementById("riskPercent");

    const timeline = document.getElementById("timeline");
    const expandedBox = document.getElementById("expandedBox");
    const expandedLink = document.getElementById("expandedLink");
    const originalLink = document.getElementById("originalLink");

    const confidenceBox = document.getElementById("confidenceBox");
    const structureBar = document.getElementById("structureBar");
    const domainBar = document.getElementById("domainBar");
    const behaviourBar = document.getElementById("behaviourBar");

    const reasonBox = document.getElementById("reasonBox");
    const reasonList = document.getElementById("reasonList");

    btn.disabled = true;
    btn.innerText = "Scanning...";

    resultBox.classList.add("hidden");
    timeline.classList.remove("hidden");
    expandedBox.classList.add("hidden");
    confidenceBox.classList.add("hidden");
    reasonBox.classList.add("hidden");

    const steps = [
        "Initializing shield...",
        "Expanding short link...",
        "AI analysing behaviour...",
        "Risk modeling..."
    ];

    for (let step of steps) {
        status.innerText = step;
        await new Promise(r => setTimeout(r, 700));
    }

    const url = document.getElementById("urlInput").value;

    const response = await fetch("/scan", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({url})
    });

    const data = await response.json();

    status.innerText = "Analysis complete";

    timeline.classList.remove("hidden");
timeline.classList.add("completed");
    resultBox.classList.remove("hidden");

    let risk = Math.round((data.confidence || data.probability || 0) * 100);

    if(data.label === "safe"){
        resultText.innerText = "âœ”ï¸ Safe";
        resultBox.className = "result-box safe";
    }
    else if(data.label === "suspicious"){
        resultText.innerText = "âš ï¸ Suspicious";
        resultBox.className = "result-box suspicious";
    }
    else{
        resultText.innerText = "ğŸš¨ Phishing Detected";
        resultBox.className = "result-box danger";
    }

    riskFill.style.width = risk + "%";
    riskPercent.innerText = risk + "% risk";

    expandedBox.classList.remove("hidden");

originalLink.innerText = url;

if(data.expanded_url){
    expandedLink.innerText = data.expanded_url;
} else {
    expandedLink.innerText = "No redirection detected";
}

    confidenceBox.classList.remove("hidden");

    setTimeout(() => {
        structureBar.style.width = risk + "%";
        domainBar.style.width = (risk * 0.85) + "%";
        behaviourBar.style.width = (risk * 0.7) + "%";
    }, 400);

   if(data.label !== "safe"){

    reasonBox.classList.remove("hidden");
    reasonList.innerHTML = "";

    let reasons = data.reasons || [
        "Uses shortened link (possible disguise)",
        "Contains urgent action keywords",
        "Suspicious domain structure"
    ];

    reasons.forEach(r => {
        let li = document.createElement("li");
        li.innerText = r;
        reasonList.appendChild(li);
    });

}
else{
    reasonBox.classList.add("hidden");
}

    btn.disabled = false;
    btn.innerText = "Scan Now";
}
</script>

</body>
</html>