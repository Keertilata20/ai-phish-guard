<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Phish Guard</title>
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>

<div class="container">

    <h1>üõ°Ô∏è AI Phish Guard</h1>
    <p class="subtitle">Smart phishing detection powered by AI</p>

    <div class="scan-box">
        <input id="urlInput" placeholder="Enter URL to scan..." />
        <button onclick="scanURL()" id="scanBtn">Scan Now</button>
    </div>

    <div id="scanStatus" class="scan-status"></div>

    <div id="resultBox" class="result-box hidden">
        <h2 id="resultText"></h2>
        <div class="risk-bar">
            <div id="riskFill"></div>
        </div>
        <p id="riskPercent"></p>
    </div>

</div>

<script>
async function scanURL() {

    const btn = document.getElementById("scanBtn");
    const status = document.getElementById("scanStatus");
    const resultBox = document.getElementById("resultBox");
    const resultText = document.getElementById("resultText");
    const riskFill = document.getElementById("riskFill");
    const riskPercent = document.getElementById("riskPercent");

    btn.disabled = true;
    btn.innerText = "Scanning...";

    resultBox.classList.add("hidden");

    const steps = [
        "Initializing security shield...",
        "Expanding domain...",
        "Analyzing patterns...",
        "AI decision engine running..."
    ];

    for (let step of steps) {
        status.innerText = step;
        await new Promise(r => setTimeout(r, 800));
    }

    const url = document.getElementById("urlInput").value;

    const response = await fetch("/scan", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({url})
    });

    const data = await response.json();

    status.innerText = "Analysis complete";

    resultBox.classList.remove("hidden");

    let risk = Math.round((data.confidence || data.probability || 0) * 100);

    if(data.label === "safe"){
        resultText.innerText = "‚úîÔ∏è Safe";
        resultBox.className = "result-box safe";
    }
    else if(data.label === "suspicious"){
        resultText.innerText = "‚ö†Ô∏è Suspicious";
        resultBox.className = "result-box suspicious";
    }
    else{
        resultText.innerText = "üö® Phishing Detected";
        resultBox.className = "result-box danger";
    }

    riskFill.style.width = risk + "%";
    riskPercent.innerText = risk + "% risk";

    btn.disabled = false;
    btn.innerText = "Scan Now";
}
</script>

</body>
</html>