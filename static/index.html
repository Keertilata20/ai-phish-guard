<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Phish Guard</title>
<link rel="stylesheet" href="/static/style.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>

<div class="container">

<h1>üõ°Ô∏è AI Phish Guard</h1>
<p class="tagline">Detecting deception before it detects you</p>
<div class="lang-toggle">
    <button onclick="setLang('en')" id="enBtn">English</button>
    <button onclick="setLang('hi')" id="hiBtn">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
</div>

<div class="input-area">
<input type="text" id="urlInput" placeholder="Enter URL to scan...">
<button id="scanBtn" onclick="scanURL()">Scan Now</button>
</div>

<p id="scanStatus"></p>

<!-- RESULT -->

<div id="resultBox" class="result-box hidden">
    <h2 id="resultText"></h2>

    <div class="risk-bar">
        <div id="riskFill"></div>
    </div>
    <p id="riskPercent"></p>
</div>

<!-- TIMELINE -->

<div id="timeline" class="timeline hidden">
<p id="step1"></p>
<p id="step2"></p>
<p id="step3"></p>
<p id="step4"></p>
</div>
<!-- EXPANDED LINK -->

<div id="expandedBox" class="expanded hidden">
    <h3>Link Analysis</h3>

    <p><strong>Original:</strong></p>
    <p id="originalLink"></p>

    <p><strong>Expanded Destination:</strong></p>
    <p id="expandedLink"></p>
</div>

<!-- CONFIDENCE -->

<div id="confidenceBox" class="confidence hidden">

<h3>Confidence Breakdown</h3>

<div class="bar">
<span>Structure Risk</span>
<div class="bar-bg"><div id="structureBar"></div></div>
</div>

<div class="bar">
<span>Domain Risk</span>
<div class="bar-bg"><div id="domainBar"></div></div>
</div>

<div class="bar">
<span>Behaviour Risk</span>
<div class="bar-bg"><div id="behaviourBar"></div></div>
</div>

</div>

<!-- REASONS -->

<div id="reasonBox" class="reason-box hidden">
<h3 id="reasonTitle">Why this link is risky ?</h3>
<ul id="reasonList"></ul>
</div>

</div>

<script>

let currentLang = "en";

function setLang(lang){
    currentLang = lang;

    const btn = document.getElementById("scanBtn");
    const enBtn = document.getElementById("enBtn");
    const hiBtn = document.getElementById("hiBtn");

    if(currentLang === "hi"){
        btn.innerText = "‡§∏‡•ç‡§ï‡•à‡§® ‡§ï‡§∞‡•á‡§Ç";
        hiBtn.style.opacity = "1";
        enBtn.style.opacity = "0.5";
    } else {
        btn.innerText = "Scan Now";
        hiBtn.style.opacity = "0.5";
        enBtn.style.opacity = "1";
    }
}

async function scanURL() {

    const btn = document.getElementById("scanBtn");
    const status = document.getElementById("scanStatus");
    const resultBox = document.getElementById("resultBox");
    const resultText = document.getElementById("resultText");
    const riskFill = document.getElementById("riskFill");
    const riskPercent = document.getElementById("riskPercent");

    const timeline = document.getElementById("timeline");
    const expandedBox = document.getElementById("expandedBox");
    const expandedLink = document.getElementById("expandedLink");
    const originalLink = document.getElementById("originalLink");

    const confidenceBox = document.getElementById("confidenceBox");
    const structureBar = document.getElementById("structureBar");
    const domainBar = document.getElementById("domainBar");
    const behaviourBar = document.getElementById("behaviourBar");

    const reasonBox = document.getElementById("reasonBox");
    const reasonList = document.getElementById("reasonList");

    btn.disabled = true;
    btn.innerText = currentLang === "hi" ? "‡§ú‡§æ‡§Å‡§ö ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à..." : "Scanning...";

    resultBox.classList.add("hidden");
    expandedBox.classList.add("hidden");
    confidenceBox.classList.add("hidden");
    reasonBox.classList.add("hidden");

    timeline.classList.remove("hidden");
    if(currentLang === "hi"){
    document.getElementById("step1").innerText = "üîí ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...";
    document.getElementById("step2").innerText = "üåê ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...";
    document.getElementById("step3").innerText = "üß† AI ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à...";
    document.getElementById("step4").innerText = "‚ö†Ô∏è ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...";
} else {
    document.getElementById("step1").innerText = "üîí Initializing shield...";
    document.getElementById("step2").innerText = "üåê Expanding short link...";
    document.getElementById("step3").innerText = "üß† AI analysing behaviour...";
    document.getElementById("step4").innerText = "‚ö†Ô∏è Risk modeling...";
}

    const steps = currentLang === "hi"
    ? [
        "üîí ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...",
        "üåê ‡§≤‡§ø‡§Ç‡§ï ‡§ï‡§æ ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...",
        "üß† AI ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à...",
        "‚ö†Ô∏è ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à..."
    ]
    : [
        "üîí Initializing shield...",
        "üåê Expanding short link...",
        "üß† AI analysing behaviour...",
        "‚ö†Ô∏è Risk modeling..."
    ];

    for (let step of steps) {
        status.innerText = step;
        await new Promise(r => setTimeout(r, 700));
    }

    const url = document.getElementById("urlInput").value;

    const response = await fetch("/scan", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({url})
    });

    const data = await response.json();

    status.innerText = currentLang === "hi" ? "‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£ ‡§™‡•Ç‡§∞‡§æ ‡§π‡•Å‡§Ü" : "Analysis complete";

    resultBox.classList.remove("hidden");

    let risk = Math.round((data.confidence || data.probability || 0) * 100);

    if(data.label === "safe"){
        resultText.innerText = currentLang === "hi" ? "‚úîÔ∏è ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§" : "‚úîÔ∏è Safe";
        resultBox.className = "result-box safe";
    }
    else if(data.label === "suspicious"){
        resultText.innerText = currentLang === "hi" ? "‚ö†Ô∏è ‡§∏‡§Ç‡§¶‡§ø‡§ó‡•ç‡§ß" : "‚ö†Ô∏è Suspicious";
        resultBox.className = "result-box suspicious";
    }
    else{
        resultText.innerText = currentLang === "hi" ? "üö® ‡§´‡§º‡§ø‡§∂‡§ø‡§Ç‡§ó ‡§≤‡§ø‡§Ç‡§ï ‡§Æ‡§ø‡§≤‡§æ" : "üö® Phishing Detected";
        resultBox.className = "result-box danger";
    }

    riskFill.style.width = risk + "%";
    riskPercent.innerText = currentLang === "hi"
        ? risk + "% ‡§ú‡•ã‡§ñ‡§ø‡§Æ"
        : risk + "% risk";

    expandedBox.classList.remove("hidden");
    originalLink.innerText = url;

    expandedLink.innerText = data.expanded_url
        ? data.expanded_url
        : (currentLang === "hi" ? "‡§ï‡•ã‡§à ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§∂‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ" : "No redirection detected");

    document.querySelector("#expandedBox h3").innerText =
        currentLang === "hi" ? "‡§≤‡§ø‡§Ç‡§ï ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£" : "Link Analysis";

    confidenceBox.classList.remove("hidden");

    document.querySelector("#confidenceBox h3").innerText =
        currentLang === "hi" ? "‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£" : "Confidence Breakdown";

    setTimeout(() => {
        structureBar.style.width = risk + "%";
        domainBar.style.width = (risk * 0.85) + "%";
        behaviourBar.style.width = (risk * 0.7) + "%";
    }, 400);

    if(data.label !== "safe"){

        reasonBox.classList.remove("hidden");
        reasonList.innerHTML = "";

        document.querySelector("#reasonBox h3").innerText =
            currentLang === "hi"
            ? "‡§Ø‡§π ‡§≤‡§ø‡§Ç‡§ï ‡§ú‡•ã‡§ñ‡§ø‡§Æ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§π‡•à?"
            : "Why this link is risky?";

        let reasons = [];

        if(data.flags){

            if(data.flags.shortened){
                reasons.push(currentLang === "hi"
                    ? "‡§≤‡§ø‡§Ç‡§ï ‡§õ‡•ã‡§ü‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ‚Äî ‡§Ö‡§∏‡§≤‡•Ä ‡§ó‡§Ç‡§§‡§µ‡•ç‡§Ø ‡§õ‡§ø‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à"
                    : "The link uses a shortened format, which can hide the real destination.");
            }

            if(data.flags.urgent){
                reasons.push(currentLang === "hi"
                    ? "‡§Ø‡§π ‡§≤‡§ø‡§Ç‡§ï ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡§¨‡§æ‡§µ ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à"
                    : "The link creates urgency to push quick action.");
            }

            if(data.flags.phishing_words){
                reasons.push(currentLang === "hi"
                    ? "‡§´‡§º‡§ø‡§∂‡§ø‡§Ç‡§ó ‡§Æ‡•á‡§Ç ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§∂‡§¨‡•ç‡§¶ ‡§™‡§æ‡§è ‡§ó‡§è"
                    : "Suspicious wording commonly seen in phishing attempts was detected.");
            }

            if(data.flags.hindi){
                reasons.push(currentLang === "hi"
                    ? "‡§≤‡§ø‡§Ç‡§ï ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à"
                    : "The link appears to target Hindi-speaking users.");
            }

            if(data.flags.hindi_phishing){
                reasons.push(currentLang === "hi"
                    ? "‡§ß‡•ã‡§ñ‡§æ‡§ß‡§°‡§º‡•Ä ‡§µ‡§æ‡§≤‡•á ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§∂‡§¨‡•ç‡§¶ ‡§™‡§æ‡§è ‡§ó‡§è"
                    : "Deceptive Hindi wording was detected.");
            }

            if(data.flags.structure){
                reasons.push(currentLang === "hi"
                    ? "‡§°‡•ã‡§Æ‡•á‡§® ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§Ö‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§≤‡§ó‡§§‡•Ä ‡§π‡•à"
                    : "The domain structure looks unusual or misleading.");
            }
        }

        if(reasons.length === 0){
            reasons.push(currentLang === "hi"
                ? "‡§ï‡§à ‡§∏‡•Ç‡§ï‡•ç‡§∑‡•ç‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§™‡§æ‡§è ‡§ó‡§è"
                : "Multiple subtle risk signals were detected.");
        }

        reasons.forEach(r => {
            let li = document.createElement("li");
            li.innerText = r;
            reasonList.appendChild(li);
        });
    }
    else{
        reasonBox.classList.add("hidden");
    }

    btn.disabled = false;
    btn.innerText = currentLang === "hi" ? "‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∏‡•ç‡§ï‡•à‡§® ‡§ï‡§∞‡•á‡§Ç" : "Scan Again";
}

</script>
</body>
</html>